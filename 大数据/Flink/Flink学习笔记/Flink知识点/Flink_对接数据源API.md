# FLINK CDC

## 1. CDC概述

> CDC 的全程是 Change Data Capture，在广义的概念上， 只要是能捕获到数据变更的技术， 都可以称为CDC技术。目前通常描述的CDC技术主要是面向数据库的变更，是一种用于捕获数据库中数据变更的技术。

### 1.1 CDC技术的应用场景

1. 数据同步：用于备份， 容灾
2. 数据分发：一个数据源分发给多个下游系统处理
3. 数据采集：面向数据仓库、数据湖的ETL数据集成，是非常重要的数据源

### 1.2 CDC的计数方案

1. **基于查询的CDC**：离线调度查询作业，批处理。把一张表同步到其他系统，每次通过查询取获取最新的数据；无法保障数据的一致性，查询的过程中有可能数据已经发生了多次变更；无法保障实时性，基于离线调度任务存在天然的延迟。
2. **基于日志的CDC**：实时消费日志，流处理，例如MySQL的binlog日志完整记录了数据库中的变更，可以把binlog文件作为流的数据源；保障数据的一致性，因为binlog文件包含了所有历史变更明细；保障实时性，因为类似binlog的日志文件是可以流式消费的，提供的是实时数据。

### 1.3 常见的CDC方案比较

1. 对比表格

   | --   | Flink CDC | Debezium | DataX | Canal | Sqoop | Kettle | Oracle Goldengate |
   | :----: | :---------: | :--------: | :-----: | :-----: | :---: | :---: | :---: |
   | CDC机制 | 日志 | 日志 | 查询 | 日志 | 查询 |查询|日志|
   | 增量同步 | √ | √ | × | √ | √ |×|√|
   | 断点续传 | √ | √ | × | √ | × |×|√|
   | 全量同步 | √ | √ | √ | × | √ |√|√|
   | 全量+增量 | √ | √ | × | × | √ |×|√|
   | 架构 | 分布式 | 单机 | 单机 | 单机 | 分布式 |分布式|分布式|
   | Transfromation | ※※※※※ | ※※ | ※※ | ※※ | ※※ |※|※|
   | 生态 | ※※※※※ | ※※※ | ※※※ | ※※※ | ※※ |※※|※※※|

2. 对比描述

   1. 对比【增量同步】的能力，基于日志的方式，可以很好的做到增量同步；而基于查询的方式是很难做到增量同步的。
   2. 对比【全量同步】的能力， 基于查询和日志的CDC方案都基本支持， 出了Canal。
   3. 对比【全量+增量】的能力， 只有 Flink CDC、Debezium、Oracle Goldengate 支持较好。
   4. 从【架构】角度去看，分为 单机和分布式，这里的分布式架构不单纯体现在数据读取能力的水平扩展上，更重要的是在大数据场景下分布式系统接入能力。例如Flink CDC的数据入湖或者入仓的时候，下游通常也是分布式系统，入Hive、HDFS、Iceberg、Hudi等，那么从接入分布式系统能力看，Flink CDC 的架构能很好的接入此类系统。
   5. 在【数据转换/数据清洗】的能力上，旨在体现当数据进入到CDC工具的时候是否可以很方便的对数据做一些过滤或者清洗，甚至是聚合？在Flink】 CDC上操作相当简单，可以通过Flink SQL 去操作这些数据，但是像 DataX、Debezium 等则需要通过脚本或者模板去做。
   6. 从【生态】角度看，这里指的是下游的一些数据库或者数据源的支持。Flink CDC 下游丰富的Connector， 例如写入到TiDB、MySQL、Pg、HBase、Kafka、ClickHouse等常见的系统。也支持各种自定义的connector。

### 1.4 Flink CDC 方案









